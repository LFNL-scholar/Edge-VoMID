# Edge-VoMID

åŸºäºåˆ†å¸ƒå¼çš„ç«¯ä¾§å£°çº¹è®¤è¯ä¸­é—´ä»¶

## é¡¹ç›®ç®€ä»‹

Edge-VoMID æ˜¯ä¸€ä¸ªåŸºäºé˜¿é‡Œè¾¾æ‘©é™¢3D Speakeræ¨¡å‹çš„åˆ†å¸ƒå¼å£°çº¹è®¤è¯ä¸­é—´ä»¶ï¼Œä¸“ä¸ºè¾¹ç¼˜è®¡ç®—å’Œé«˜å¯ç”¨ç¯å¢ƒè®¾è®¡ã€‚è¯¥ç³»ç»Ÿæä¾›å®Œæ•´çš„å£°çº¹è¯†åˆ«è§£å†³æ–¹æ¡ˆï¼ŒåŒ…æ‹¬è¯´è¯äººæ³¨å†Œã€å£°çº¹ç‰¹å¾æå–ã€å®æ—¶éªŒè¯ã€åˆ†å¸ƒå¼å­˜å‚¨ã€è´Ÿè½½å‡è¡¡å’Œç›‘æ§ç­‰åŠŸèƒ½ã€‚

## æ ¸å¿ƒç‰¹æ€§

### ğŸ¯ é«˜ç²¾åº¦è¯†åˆ«
- åŸºäºé˜¿é‡Œ3D Speakeræ¨¡å‹ï¼Œæä¾›ä¸šç•Œé¢†å…ˆçš„å£°çº¹è¯†åˆ«ç²¾åº¦
- æ”¯æŒå¤šç§éŸ³é¢‘æ ¼å¼ï¼ˆWAVã€MP3ã€FLACã€M4Aã€OGGï¼‰
- å¯é…ç½®çš„ç›¸ä¼¼åº¦é˜ˆå€¼ï¼Œå¹³è¡¡è¯†åˆ«ç²¾åº¦å’Œè¯¯è¯†ç‡

### âš¡ åˆ†å¸ƒå¼æ¶æ„
- æ”¯æŒå¤šèŠ‚ç‚¹é›†ç¾¤éƒ¨ç½²
- å¤šç§è´Ÿè½½å‡è¡¡ç­–ç•¥ï¼ˆè½®è¯¢ã€éšæœºã€æœ€å°‘è¿æ¥ã€åŠ æƒè½®è¯¢ã€æœ€å°‘å“åº”æ—¶é—´ï¼‰
- è‡ªåŠ¨å¥åº·æ£€æŸ¥å’Œæ•…éšœè½¬ç§»
- åˆ†å¸ƒå¼å£°çº¹ç‰¹å¾å­˜å‚¨ï¼ˆå†…å­˜ã€Redisã€æ–‡ä»¶ç³»ç»Ÿï¼‰

### ğŸ”§ æ˜“äºé›†æˆ
- å®Œæ•´çš„RESTful APIæ¥å£
- Pythonå®¢æˆ·ç«¯SDK
- æ”¯æŒå¤šç§éƒ¨ç½²æ–¹å¼ï¼ˆDockerã€Kubernetesï¼‰
- è¯¦ç»†çš„APIæ–‡æ¡£å’Œç¤ºä¾‹

### ğŸ“Š ç›‘æ§å’Œç®¡ç†
- å®æ—¶ç³»ç»Ÿç›‘æ§å’ŒæŒ‡æ ‡æ”¶é›†
- Prometheus + Grafanaç›‘æ§é¢æ¿
- å®Œæ•´çš„æ—¥å¿—ç®¡ç†å’Œå®¡è®¡
- é›†ç¾¤çŠ¶æ€å’Œæ€§èƒ½ç»Ÿè®¡

### ğŸ›¡ï¸ å®‰å…¨å¯é 
- æ”¯æŒAPIå¯†é’¥è®¤è¯
- è¯·æ±‚é¢‘ç‡é™åˆ¶
- æ•°æ®åŠ å¯†å’Œå¤‡ä»½
- é«˜å¯ç”¨æ€§å’Œå®¹é”™è®¾è®¡

## æŠ€æœ¯æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   API Gateway   â”‚    â”‚  Load Balancer  â”‚    â”‚  Monitoring     â”‚
â”‚   (Flask)       â”‚â—„â”€â”€â–ºâ”‚  (Round Robin)  â”‚â—„â”€â”€â–ºâ”‚  (Prometheus)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                       â”‚                       â”‚
         â–¼                       â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Voiceprint      â”‚    â”‚ Distributed     â”‚    â”‚ Health Check    â”‚
â”‚ Engine          â”‚â—„â”€â”€â–ºâ”‚ Storage         â”‚â—„â”€â”€â–ºâ”‚ Service         â”‚
â”‚ (3D Speaker)    â”‚    â”‚ (Redis/Memory)  â”‚    â”‚ (Auto Recovery) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒç»„ä»¶

- **å£°çº¹è¯†åˆ«å¼•æ“**: åŸºäºé˜¿é‡Œè¾¾æ‘©é™¢ speech_campplus_sv_zh-cn_3dspeaker_16k
- **åˆ†å¸ƒå¼å­˜å‚¨**: æ”¯æŒRedisã€å†…å­˜ã€æ–‡ä»¶ç³»ç»Ÿçš„å¤šçº§å­˜å‚¨
- **è´Ÿè½½å‡è¡¡å™¨**: å¤šç§ç­–ç•¥çš„æ™ºèƒ½è´Ÿè½½åˆ†é…
- **APIç½‘å…³**: ç»Ÿä¸€çš„APIå…¥å£å’Œè·¯ç”±ç®¡ç†
- **ç›‘æ§ç³»ç»Ÿ**: å®Œæ•´çš„ç³»ç»Ÿç›‘æ§å’Œå‘Šè­¦

## å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒè¦æ±‚

- Python 3.9+
- Docker & Docker Compose
- Redis (å¯é€‰ï¼Œç”¨äºåˆ†å¸ƒå¼å­˜å‚¨)
- PostgreSQL (å¯é€‰ï¼Œç”¨äºæ•°æ®æŒä¹…åŒ–)

### 2. å®‰è£…éƒ¨ç½²

#### ä½¿ç”¨Docker Composeï¼ˆæ¨èï¼‰

```bash
# å…‹éš†é¡¹ç›®
git clone <repository-url>
cd Edge-VoMID

# ä¸€é”®éƒ¨ç½²
./scripts/deploy.sh deploy
```

#### æ‰‹åŠ¨éƒ¨ç½²

```bash
# å®‰è£…ä¾èµ–
pip install -r requirements.txt

# å¯åŠ¨æœåŠ¡
python main.py --config config/production.yaml
```

### 3. éªŒè¯éƒ¨ç½²

```bash
# å¥åº·æ£€æŸ¥
curl http://localhost:8080/health

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
./scripts/deploy.sh status
```

## APIä½¿ç”¨ç¤ºä¾‹

### Pythonå®¢æˆ·ç«¯

```python
from client import VoMIDClient

# åˆ›å»ºå®¢æˆ·ç«¯
client = VoMIDClient("http://localhost:8080")

# æ³¨å†Œå£°çº¹
user_id = client.register_voiceprint(
    name="å¼ ä¸‰",
    audio_file="audio/zhang_san.wav",
    metadata={"department": "IT", "role": "developer"}
)

# éªŒè¯å£°çº¹
result = client.verify_voiceprint(
    audio_file="audio/test.wav",
    threshold=0.6
)

if result.verified:
    print(f"éªŒè¯æˆåŠŸ: {result.user_id}, ç½®ä¿¡åº¦: {result.confidence}")
else:
    print("éªŒè¯å¤±è´¥")
```

### REST API

```bash
# æ³¨å†Œå£°çº¹
curl -X POST http://localhost:8080/api/v1/voiceprint/register \
  -F "name=å¼ ä¸‰" \
  -F "audio=@audio/zhang_san.wav"

# éªŒè¯å£°çº¹
curl -X POST http://localhost:8080/api/v1/voiceprint/verify \
  -F "audio=@audio/test.wav" \
  -F "threshold=0.6"

# è·å–ç»Ÿè®¡ä¿¡æ¯
curl http://localhost:8080/api/v1/stats
```

## é…ç½®è¯´æ˜

### ç¯å¢ƒå˜é‡é…ç½®

```bash
# åº”ç”¨é…ç½®
export VOIMID_ENVIRONMENT=production
export VOIMID_API_HOST=0.0.0.0
export VOIMID_API_PORT=8080

# å­˜å‚¨é…ç½®
export VOIMID_STORAGE_TYPE=redis
export VOIMID_REDIS_HOST=redis
export VOIMID_REDIS_PORT=6379

# æ•°æ®åº“é…ç½®
export VOIMID_DB_HOST=postgres
export VOIMID_DB_USER=voimid
export VOIMID_DB_PASSWORD=voimid_password
```

### é…ç½®æ–‡ä»¶

æ”¯æŒYAMLå’ŒJSONæ ¼å¼çš„é…ç½®æ–‡ä»¶ï¼š

```yaml
# config/production.yaml
environment: production
api:
  host: "0.0.0.0"
  port: 8080
  max_file_size: 10485760  # 10MB

storage:
  type: "redis"
  redis:
    host: "redis"
    port: 6379

model:
  name: "iic/speech_campplus_sv_zh-cn_3dspeaker_16k"
  device: "auto"
```

## é›†ç¾¤éƒ¨ç½²

### å¤šèŠ‚ç‚¹éƒ¨ç½²

```bash
# å¯åŠ¨å¤šä¸ªèŠ‚ç‚¹
docker-compose up -d --scale voimid=3

# é…ç½®è´Ÿè½½å‡è¡¡
# Nginxä¼šè‡ªåŠ¨å°†è¯·æ±‚åˆ†å‘åˆ°ä¸åŒçš„èŠ‚ç‚¹
```

### Kuberneteséƒ¨ç½²

```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: voimid
spec:
  replicas: 3
  selector:
    matchLabels:
      app: voimid
  template:
    metadata:
      labels:
        app: voimid
    spec:
      containers:
      - name: voimid
        image: voimid:latest
        ports:
        - containerPort: 8080
        env:
        - name: VOIMID_STORAGE_TYPE
          value: "redis"
        - name: VOIMID_REDIS_HOST
          value: "redis-service"
```

## ç›‘æ§å’Œç®¡ç†

### è®¿é—®ç›‘æ§é¢æ¿

- **Prometheus**: http://localhost:9090
- **Grafana**: http://localhost:3000 (admin/admin)
- **APIæ–‡æ¡£**: http://localhost:8080/api/v1/docs

### å¸¸ç”¨ç®¡ç†å‘½ä»¤

```bash
# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
./scripts/deploy.sh status

# æŸ¥çœ‹æ—¥å¿—
./scripts/deploy.sh logs

# å¤‡ä»½æ•°æ®
./scripts/deploy.sh backup

# é‡å¯æœåŠ¡
./scripts/deploy.sh restart
```

## æ€§èƒ½ä¼˜åŒ–

### ç³»ç»Ÿè°ƒä¼˜

1. **æ¨¡å‹ä¼˜åŒ–**
   - ä½¿ç”¨GPUåŠ é€Ÿï¼ˆå¦‚æœå¯ç”¨ï¼‰
   - è°ƒæ•´æ‰¹å¤„ç†å¤§å°
   - å¯ç”¨æ¨¡å‹ç¼“å­˜

2. **å­˜å‚¨ä¼˜åŒ–**
   - ä½¿ç”¨Redisé›†ç¾¤
   - é…ç½®é€‚å½“çš„ç¼“å­˜ç­–ç•¥
   - å®šæœŸæ¸…ç†è¿‡æœŸæ•°æ®

3. **ç½‘ç»œä¼˜åŒ–**
   - é…ç½®CDNåŠ é€Ÿ
   - å¯ç”¨HTTP/2
   - ä¼˜åŒ–è´Ÿè½½å‡è¡¡ç­–ç•¥

### æ€§èƒ½æŒ‡æ ‡

- **ååé‡**: æ”¯æŒ1000+ QPS
- **å»¶è¿Ÿ**: å¹³å‡å“åº”æ—¶é—´ < 200ms
- **å¯ç”¨æ€§**: 99.9% æœåŠ¡å¯ç”¨æ€§
- **æ‰©å±•æ€§**: æ”¯æŒæ°´å¹³æ‰©å±•

## ä½¿ç”¨åœºæ™¯

### ğŸ” èº«ä»½éªŒè¯
- è¯­éŸ³é—¨ç¦ç³»ç»Ÿ
- ç”µè¯å®¢æœèº«ä»½ç¡®è®¤
- ç§»åŠ¨åº”ç”¨å£°çº¹ç™»å½•

### ğŸ“ é€šè¯ç›‘æ§
- é€šè¯å½•éŸ³è¯´è¯äººè¯†åˆ«
- å®¢æœè´¨é‡ç›‘æ§
- æ¬ºè¯ˆæ£€æµ‹

### ğŸ™ï¸ ä¼šè®®è®°å½•
- ä¼šè®®å‘è¨€è€…è‡ªåŠ¨æ ‡æ³¨
- ä¼šè®®çºªè¦ç”Ÿæˆ
- å¤šè¯­è¨€ä¼šè®®æ”¯æŒ

### ğŸ›¡ï¸ å®‰å…¨é˜²æŠ¤
- å£°çº¹åæ¬ºè¯ˆç³»ç»Ÿ
- é‡‘èäº¤æ˜“éªŒè¯
- é«˜å®‰å…¨ç­‰çº§è®¿é—®æ§åˆ¶

## æ³¨æ„äº‹é¡¹

1. **éŸ³é¢‘è´¨é‡**: å»ºè®®ä½¿ç”¨æ¸…æ™°ã€æ— å™ªéŸ³çš„éŸ³é¢‘æ–‡ä»¶
2. **é‡‡æ ·ç‡**: æ”¯æŒ16kHzé‡‡æ ·ç‡ï¼Œè‡ªåŠ¨æ ¼å¼è½¬æ¢
3. **æ—¶é•¿è¦æ±‚**: å»ºè®®éŸ³é¢‘æ—¶é•¿åœ¨1-30ç§’ä¹‹é—´
4. **é˜ˆå€¼è®¾ç½®**: æ ¹æ®å®é™…åœºæ™¯è°ƒæ•´ç›¸ä¼¼åº¦é˜ˆå€¼
5. **æ•°æ®å®‰å…¨**: å£°çº¹ç‰¹å¾ç»è¿‡åŠ å¯†å­˜å‚¨
6. **åˆè§„æ€§**: éµå¾ªæ•°æ®ä¿æŠ¤æ³•è§„è¦æ±‚

## å¼€å‘å’Œè´¡çŒ®

### å¼€å‘ç¯å¢ƒè®¾ç½®

```bash
# å®‰è£…å¼€å‘ä¾èµ–
pip install -r requirements.txt
pip install -r requirements-dev.txt

# è¿è¡Œæµ‹è¯•
pytest tests/

# ä»£ç æ ¼å¼åŒ–
black .
flake8 .

# ç”Ÿæˆæ–‡æ¡£
sphinx-build docs/ docs/_build/
```

### è´¡çŒ®æŒ‡å—

1. Fork é¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯
3. æäº¤æ›´æ”¹
4. æ¨é€åˆ°åˆ†æ”¯
5. åˆ›å»º Pull Request

## è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ Apache è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚


**Edge-VoMID** - è®©åˆ†å¸ƒå¼å£°çº¹è®¤è¯æ›´ç®€å•ã€æ›´é«˜æ•ˆã€æ›´å¯é 